@model NeuralPlay.Models.InvitacionViewModel

@{
	ViewData["Title"] = "Detalle de invitacion";
	ViewBag.OcultarNavbar = true;
}

@Html.Partial("~/Views/Shared/_SidebarLeft.cshtml")
@Html.Partial("~/Views/Shared/_SidebarRight.cshtml")
@Html.Partial("~/Views/Shared/_SidebarDown.cshtml")

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<style>
	:root {
		--np-red: #e50a46;
		--np-grey: #454545;
		--np-dark-grey: #242424;
	}

	@@font-face {
		font-family: 'Neue';
		src: url('/Recursos/NeuePower-Ultra.ttf') format('truetype');
		font-weight: normal;
		font-style: normal;
	}

	@@font-face {
		font-family: 'Lexend';
		src: url('/Recursos/Lexend-Medium.ttf') format('truetype');
		font-weight: normal;
		font-style: normal;
	}

	body {
		margin: 0;
		padding: 0;
		overflow-x: hidden;
		color: white;
		background: url('/Recursos/WALLPAPER_GRIS.png') no-repeat center center fixed;
		background-size: cover;
	}

	.content-container {
		width: 78%;
		margin: 0 auto;
		min-height: 100vh;
		padding: 60px 0 60px 0;
		display: flex;
		flex-direction: column;
		gap: 20px;
	}

	.page-header {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 16px;
	}

	.page-title {
		font-family: 'Neue', sans-serif;
		font-size: 3.8rem;
		color: white;
		margin: 0;
		text-transform: uppercase;
		letter-spacing: 1px;
	}

	.page-subtitle {
		font-family: 'Lexend', sans-serif;
		color: #d7d7d7;
		margin: 6px 0 0 0;
		font-size: 1.05rem;
	}

	.card-panel {
		background: rgba(36, 36, 36, 0.94);
		border-radius: 12px;
		padding: 24px;
		box-shadow: 0 10px 28px rgba(0, 0, 0, 0.35);
		border: 1px solid rgba(255, 255, 255, 0.06);
		width: 100%;
	}

	.meta-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
		gap: 14px;
		padding: 16px;
		background: rgba(255, 255, 255, 0.03);
		border: 1px solid rgba(255, 255, 255, 0.08);
		border-radius: 10px;
		margin-top: 8px;
	}

	.meta-label {
		font-family: 'Lexend', sans-serif;
		color: #9fb1c1;
		font-size: 0.95rem;
		margin-bottom: 4px;
	}

	.meta-value {
		font-family: 'Lexend', sans-serif;
		color: white;
		font-size: 1.05rem;
		word-break: break-word;
	}

	.badge-pill {
		padding: 8px 14px;
		border-radius: 999px;
		border: 1px solid rgba(255, 255, 255, 0.1);
		background: rgba(255, 255, 255, 0.05);
		font-size: 0.85rem;
		display: inline-flex;
		align-items: center;
		gap: 6px;
		white-space: nowrap;
	}

	.badge-estado-pendiente {
		background: rgba(255, 152, 0, 0.1);
		border-color: #ff9800;
		color: #fff3cd;
	}

	.badge-estado-aceptada {
		background: rgba(76, 175, 80, 0.1);
		border-color: #4caf50;
		color: #d4edda;
	}

	.badge-estado-rechazada {
		background: rgba(244, 67, 54, 0.1);
		border-color: #f44336;
		color: #ffe3e0;
	}

	.actions {
		display: flex;
		gap: 12px;
		flex-wrap: wrap;
		margin-top: 18px;
	}

	.btn-primary-ghost,
	.btn-danger-solid,
	.btn-secondary-ghost,
	.btn-success-solid {
		font-family: 'Lexend', sans-serif;
		padding: 12px 18px;
		border-radius: 12px;
		text-decoration: none;
		border: 1px solid transparent;
		display: inline-flex;
		align-items: center;
		gap: 8px;
		color: white;
		cursor: pointer;
		transition: all 0.2s ease;
		background: rgba(255, 255, 255, 0.04);
	}

	.btn-secondary-ghost { border-color: rgba(255, 255, 255, 0.2); }
	.btn-secondary-ghost:hover { background: rgba(255, 255, 255, 0.12); }

	.btn-primary-ghost { border-color: #2196F3; color: #e3f2fd; }
	.btn-primary-ghost:hover { background: #2196F3; color: #0d1b2a; }

	.btn-success-solid { background: #4caf50; border-color: #4caf50; }
	.btn-success-solid:hover { filter: brightness(1.05); transform: translateY(-1px); }

	.btn-danger-solid { background: var(--np-red); border-color: var(--np-red); }
	.btn-danger-solid:hover { filter: brightness(1.05); transform: translateY(-1px); }
</style>

@{
	var uid = Context.Session.GetInt32("UsuarioId");
	bool isDest = uid.HasValue && Model.DestinatarioId.HasValue && uid.Value == Model.DestinatarioId.Value;
}

<div class="content-container">
	<div class="page-header">
		<div>
			<h1 class="page-title">Invitacion @Model.IdInvitacion</h1>
			<p class="page-subtitle">Consulta los detalles y acciones disponibles</p>
		</div>
		<a asp-action="Index" class="btn-secondary-ghost"><i class="bi bi-arrow-left"></i> Volver</a>
	</div>

	<section class="card-panel">
		<div class="meta-grid">
			<div>
				<div class="meta-label">Estado</div>
				@if (Model.Estado.ToString() == "PENDIENTE")
				{
					<span class="badge-pill badge-estado-pendiente"><i class="bi bi-hourglass-split"></i> Pendiente</span>
				}
				else if (Model.Estado.ToString() == "ACEPTADA")
				{
					<span class="badge-pill badge-estado-aceptada"><i class="bi bi-check-circle"></i> Aceptada</span>
				}
				else
				{
					<span class="badge-pill badge-estado-rechazada"><i class="bi bi-x-circle"></i> Rechazada</span>
				}
			</div>
			<div>
				<div class="meta-label">Tipo</div>
				<div class="meta-value">@Model.Tipo</div>
			</div>
			<div>
				<div class="meta-label">Emisor</div>
				<div class="meta-value">@Model.EmisorNick</div>
			</div>
			<div>
				<div class="meta-label">Destinatario</div>
				<div class="meta-value">@Model.DestinatarioNick</div>
			</div>
			<div>
				<div class="meta-label">Fecha envio</div>
				<div class="meta-value">@Model.FechaEnvio.ToString("dd/MM/yyyy")</div>
			</div>
			<div>
				<div class="meta-label">Destino</div>
				<div class="meta-value">
					@if (Model.Tipo == ApplicationCore.Domain.Enums.TipoInvitacion.EQUIPO)
					{
						<text>Equipo: @Model.EquipoNombre</text>
					}
					else
					{
						<text>Comunidad: @Model.ComunidadNombre</text>
					}
				</div>
			</div>
		</div>

		<div class="actions">
			<a asp-action="Index" class="btn-secondary-ghost"><i class="bi bi-list"></i> Ver listado</a>

			@if (Model.Estado.ToString() == "PENDIENTE" && isDest)
			{
				<form asp-action="Accept" method="post" style="display: inline;">
					<input type="hidden" name="id" value="@Model.IdInvitacion" />
					<button type="submit" class="btn-success-solid"><i class="bi bi-check"></i> Aceptar</button>
				</form>
				<form asp-action="Reject" method="post" style="display: inline;">
					<input type="hidden" name="id" value="@Model.IdInvitacion" />
					<button type="submit" class="btn-danger-solid"><i class="bi bi-x"></i> Rechazar</button>
				</form>
			}

			@if (Model.Estado.ToString() != "ACEPTADA")
			{
				<a asp-action="Delete" asp-route-id="@Model.IdInvitacion" class="btn-danger-solid" style="margin-left: 12px;"><i class="bi bi-trash"></i> Eliminar</a>
			}
		</div>
	</section>
</div>

